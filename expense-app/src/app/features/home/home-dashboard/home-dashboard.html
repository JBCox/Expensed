<div class="jensify-premium-mesh-bg">
  <div
    class="jensify-container"
    style="padding-top: 2rem; padding-bottom: 2rem"
  >
    <div class="home-layout jensify-mb-xl">
      <mat-card class="hero-card jensify-card jensify-glass-card">
        <div class="hero-copy">
          <p class="eyebrow">Welcome back</p>
          <h1>Hi {{ (user$ | async)?.full_name || 'there' }} ðŸ‘‹</h1>
          <p class="subtitle">
            Capture receipts, finish drafts, and keep approvals moving.
          </p>
          <div class="quick-actions">
            <button
              mat-raised-button
              color="primary"
              routerLink="/expenses/upload"
            >
              <mat-icon>photo_camera</mat-icon>
              Add Receipt
            </button>
            <button
              mat-stroked-button
              color="primary"
              routerLink="/expenses/new"
            >
              <mat-icon>note_add</mat-icon>
              New Expense
            </button>
            <button
              mat-button
              class="text-action"
              routerLink="/approvals"
              *ngIf="(isFinanceOrAdmin$ | async)"
            >
              <mat-icon>approval</mat-icon>
              Review Approvals
            </button>
          </div>
        </div>
        <mat-card class="stats-card jensify-card jensify-glass-card">
          <div>
            <p class="label">Unreported expenses</p>
            <p class="value">{{ (unreportedCount$ | async) ?? 0 }}</p>
          </div>
          <div>
            <p class="label">Draft reports</p>
            <p class="value">{{ (draftReportsCount$ | async) ?? 0 }}</p>
          </div>
          <div>
            <p class="label">Submitted reports</p>
            <p class="value">{{ (submittedReportsCount$ | async) ?? 0 }}</p>
          </div>
          <div>
            <p class="label">Approved (unpaid)</p>
            <p class="value">{{ (approvedReportsCount$ | async) ?? 0 }}</p>
          </div>
        </mat-card>
      </mat-card>

      <div class="content-grid jensify-grid-2">
        <mat-card class="todo-card jensify-card jensify-glass-card">
          <h2>Next Up</h2>
          <p class="hint">Group expenses into reports, then submit.</p>
          <div class="todo-item">
            <div>
              <p>Unreported expenses</p>
              <span>{{ (unreportedCount$ | async) ?? 0 }} need adding to a
                report</span>
            </div>
            <button mat-button color="primary" routerLink="/expenses">
              Review expenses
            </button>
          </div>
          <div class="todo-item">
            <div>
              <p>Draft reports</p>
              <span>Create or submit your report.</span>
            </div>
            <button mat-button color="primary" routerLink="/reports">
              Go to reports
            </button>
          </div>
        </mat-card>

        <mat-card class="recent-card jensify-card jensify-glass-card">
          <div class="recent-header">
            <div>
              <h2>Recent activity</h2>
              <p class="hint">Latest four expenses</p>
            </div>
            <button mat-stroked-button routerLink="/expenses/new">
              View all soon
            </button>
          </div>
          <ng-container
            *ngIf="(recentExpenses$ | async) as recent; else emptyState"
          >
            <div class="recent-list" *ngIf="recent.length; else emptyState">
              <div class="recent-row" *ngFor="let expense of recent">
                <div>
                  <p class="merchant">{{ expense.merchant }}</p>
                  <p class="meta">
                    {{ expense.expense_date | date:'MMM d' }} Â· {{
                    expense.status | titlecase }}
                  </p>
                </div>
                <div class="amount">
                  {{ expense.amount | currency:'USD':'symbol':'1.0-0' }}
                </div>
              </div>
            </div>
          </ng-container>
          <ng-template #emptyState>
            <p class="empty">
              No expenses yet. Upload a receipt to get started.
            </p>
          </ng-template>
        </mat-card>
      </div>
    </div>
  </div>
</div>
